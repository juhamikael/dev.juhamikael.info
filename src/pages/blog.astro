---
import Layout from "../layouts/Layout.astro";
import { getCollection } from "astro:content";
const blog = await getCollection("blog");
import createSlug from "../lib/createSlug";
import { Icon } from "astro-icon";
import { getDate } from "../lib/utils";
import "../styles/globals.css";

const recentBlogPosts = [...blog].sort(
  (a, b) =>
    (new Date(b.data.createdAt) as unknown as number) -
    (new Date(a.data.createdAt) as unknown as number)
);
---

<Layout>
  <section class="grid grid-cols-3">
    <h1 class="col-start-2 text-3xl font-bold underline">Blog</h1>
  </section>

  <div class="flex justify-center">
    <div class="mx-14 w-full lg:mx-0 lg:w-1/3">
      {
        recentBlogPosts.map((post) => (
          <>
            <a href={`/blog/${createSlug(post.data.title)}`} class="p-2">
              <div class="zoom flex h-32 flex-col place-content-center rounded-xl p-2 hover:bg-gray-700/20  ">
                <h1 class="change-text-color text-base font-bold text-yellow-300">
                  {post.data.title}
                </h1>

                <p class="mt-4 text-sm text-gray-500">{post.data.preview}</p>
                <div class="mt-4 flex flex-row place-items-center">
                  <Icon
                    pack="ion"
                    name="calendar-clear-outline"
                    class="mr-2 w-5"
                  />
                  <p class="text-sm">{getDate(post.data.createdAt)}</p>
                </div>
              </div>
            </a>
            <div class="flex justify-center">
              <div class="my-4 w-full border border-gray-200/5" />
            </div>
          </>
        ))
      }
    </div>
  </div>
</Layout>
